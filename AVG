using System;
using System.Collections.Generic;

namespace ConsoleApp6
{
    class Program
    {

        static void Main(string[] args)
        {
            List<string> missionList = new List<string>();
            missionList = SaveFile.GetAllLinesFromCardProcess();
        }

        public string[] GetWorkers(List<string> missionList)
        {
            bool flag;
            string[] seperate = new string[5];
            string[] workers = new string[10];

            for (int i = 0; i < missionList.Count; i++)
            {
                flag = true;
                seperate = missionList[i].Split("@@");

                for (int a = 0; a < workers.Length; a++)
                {
                    if (seperate[0].Equals(workers[a]))
                    {
                        flag = false;
                        break;
                    }
                }
                if (flag)
                {
                    workers[i] = seperate[0];
                }
            }
            return workers;
        }

        public string[] GetCards(List<string> missionList)
        {
            bool flag;
            string[] seperate = new string[5];
            string[] cards = new string[10];

            for (int i = 0; i < missionList.Count; i++)
            {
                flag = true;
                seperate = missionList[i].Split("@@");

                for (int a = 0; a < cards.Length; a++)
                {
                    if (seperate[0].Equals(cards[a]))
                    {
                        flag = false;
                        break;
                    }
                }
                if (flag)
                {
                    cards[i] = seperate[0];
                }
            }
            return cards;
        }
            public List<string> AvgTimeByCardAndWorker(List<string> missionList)
            {
                List<string> temp, finalAvgTimes = new List<string>();
                string[] seperate = new string[5];
                string[] workers = new string[10];
                string[] cards = new string[10];
                string thisWorker;
                int timesum = 0, count = 0;

                workers = GetWorkers(missionList);
                cards = GetCards(missionList);

                for (int i = 0; i < missionList.Count; i++)
                {
                    temp = SaveFile.GetAllLinesFilteredByEmpId(workers[i]);

                    for (int j = 0; j < temp.Count; j++)
                    {
                        seperate = temp[i].Split("@@");
                        if(seperate[0]==cards[i])
                        {
                            timesum += int.Parse(seperate[3]) * int.Parse(seperate[4]);
                            count += int.Parse(seperate[4]);
                        }
                    }
                    thisWorker = workers[i] + "@@" +cards[i]+ "@@" + (timesum / count).ToString(); //workerID@@cardID@@AVGtime
                    finalAvgTimes[i] = thisWorker;
                }
                return finalAvgTimes;
            }


        public List<string> AvgTimeByCard(List<string> missionList)
        {
            List<string> temp,finalAvgTimes= new List<string>();
            string[] seperate = new string[5];
            string[] cards = new string[10];
            string thisWorker;
            int timesum = 0, count = 0;

            cards = GetCards(missionList);

            for (int i = 0; i < missionList.Count; i++)
            {
                temp = SaveFile.GetAllLinesFilteredByCardId(cards[i]);
                for (int j = 0; j < temp.Count; j++)
                {
                    seperate = temp[i].Split("@@");
                    timesum += int.Parse(seperate[3]) * int.Parse(seperate[4]);
                    count += int.Parse(seperate[4]);
                }
                thisWorker = cards[i] + "@@" + (timesum / count).ToString(); //cardID@@AVGtime
                finalAvgTimes[i] = thisWorker;
            }
            return finalAvgTimes;
        }
    }
}
